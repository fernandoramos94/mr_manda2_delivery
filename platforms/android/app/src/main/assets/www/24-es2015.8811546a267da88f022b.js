(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{akYc:function(t,e,n){"use strict";n.r(e),n.d(e,"TrackerPageModule",function(){return O});var o=n("ofXK"),i=n("3Pt+"),a=n("TEn/"),r=n("tyNb"),s=n("H+bZ"),l=n("2Rin"),c=n("m/P+"),d=n("fXoL");const g=["map"];function p(t,e){if(1&t&&(d.Ob(0,"span",19),d.qc(1),d.Nb()),2&t){const t=d.Yb();d.Ab(1),d.tc("",t.util.currecny," ",t.grandTotal,"")}}function b(t,e){if(1&t&&(d.Ob(0,"span",19),d.qc(1),d.Nb()),2&t){const t=d.Yb();d.Ab(1),d.tc("",t.grandTotal," ",t.util.currecny," ")}}const _=function(t){return{"background-image":t}},u=[{path:"",component:(()=>{class t{constructor(t,e,n,o){this.route=t,this.api=e,this.util=n,this.iab=o,this.id="",this.phone="",this.status="",this.totalOrders=[]}ngOnInit(){this.route.queryParams.subscribe(t=>{console.log("data=>",t),t.hasOwnProperty("id")&&(this.id=t.id,this.getOrder())})}callDriver(){this.iab.create("tel:"+this.phone,"_system")}getOrder(){this.api.post("orders/getById",{id:this.id}).then(t=>{if(console.log(t),t&&200===t.status&&t.data.length){const e=t.data[0];if(this.totalOrders=JSON.parse(e.orders),this.grandTotal=e.grand_total,this.status=e.status,this.payMethod="cod"===e.pay_method?"COD":"PAID",this.getUserInfo(e.uid),e&&e.address){const t=JSON.parse(e.address);this.address=t.house+" "+t.landmark+" "+t.address+" "+t.pincode,console.log(t),this.myLat=t.lat,this.myLng=t.lng,this.loadMap(parseFloat(localStorage.getItem("lat")),parseFloat(localStorage.getItem("lng")),parseFloat(this.myLat),parseFloat(this.myLng))}}else this.util.back()},t=>{console.log("error in orders",t),this.util.errorToast("Algo ha ido mal")}).catch(t=>{console.log("error in order",t),this.util.errorToast("Algo ha ido mal")})}getUserInfo(t){this.api.post("users/getById",{id:t}).then(t=>{if(console.log(t),t&&200===t.status&&t.data.length){const e=t.data[0];console.log("userinfo=====>>>",e),this.username=e.first_name+" "+e.last_name,this.phone=e.mobile,this.cover=e.cover}},t=>{console.log(t),this.util.errorToast("Algo ha ido mal")}).catch(t=>{console.log(t),this.util.errorToast("Algo ha ido mal")})}changeMarkerPosition(t,e){const n=new google.maps.LatLng(parseFloat(localStorage.getItem("lat")),parseFloat(localStorage.getItem("lng")));e.setCenter(n),t.setPosition(n)}loadMap(t,e,n,o){const i=new google.maps.DirectionsService;let a=new google.maps.DirectionsRenderer;a=new google.maps.DirectionsRenderer;const r=new google.maps.LatLngBounds,s={lat:parseFloat(t),lng:parseFloat(e)},l={lat:n,lng:o},c=new google.maps.Map(this.mapElement.nativeElement,{center:{lat:t,lng:e},disableDefaultUI:!0,zoom:100}),d=new google.maps.LatLng(t,e),g=new google.maps.LatLng(n,o),p={url:"assets/pin.png",scaledSize:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},b=new google.maps.Marker({map:c,position:d,animation:google.maps.Animation.DROP,icon:p}),_=new google.maps.Marker({map:c,position:g,animation:google.maps.Animation.DROP,icon:p});b.setMap(c),_.setMap(c),a.setMap(c),a.setOptions({polylineOptions:{strokeWeight:4,strokeOpacity:1,strokeColor:"#ff384c"},suppressMarkers:!0});const u=new google.maps.Geocoder;(new google.maps.DistanceMatrixService).getDistanceMatrix({origins:[s],destinations:[l],travelMode:"DRIVING",unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1},function(t,e){if("OK"!==e)alert("Error was: "+e);else{const e=t.originAddresses,n=t.destinationAddresses,o=function(t){return function(t,e){"OK"===e?c.fitBounds(r.extend(t[0].geometry.location)):alert("Geocode was not successful due to: "+e)}};i.route({origin:s,destination:l,travelMode:"DRIVING"},function(t,e){"OK"===e?a.setDirections(t):window.alert("Directions request failed due to "+e)});for(let i=0;i<e.length;i++){const a=t.rows[i].elements;u.geocode({address:e[i]},o(!1));for(let t=0;t<a.length;t++)u.geocode({address:n[t]},o(!0))}}}),this.interval=setInterval(()=>{this.changeMarkerPosition(b,c)},12e3)}ionViewDidLeave(){console.log("leaae"),clearInterval(this.interval)}}return t.\u0275fac=function(e){return new(e||t)(d.Lb(r.a),d.Lb(s.a),d.Lb(l.a),d.Lb(c.a))},t.\u0275cmp=d.Fb({type:t,selectors:[["app-tracker"]],viewQuery:function(t,e){if(1&t&&d.vc(g,3),2&t){let t;d.jc(t=d.Xb())&&(e.mapElement=t.first)}},decls:36,vars:16,consts:[["color","primary"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back"],[1,"main_content_div"],[1,"upper_div"],["id","map",1,"map"],["map",""],[1,"lower_div"],[1,"head_lbl"],[1,"driver_detail_div"],[1,"back_image",3,"ngStyle"],[2,"padding-left","20px"],[1,"boy_name"],[1,"address"],["size","small","fill","outline",3,"click"],[1,"order_detail"],["style","color: var(--ion-color-primary);position: absolute;right: 20px;",4,"ngIf"],[1,"order_status"],[2,"color","var(--ion-color-primary)","position","absolute","right","20px"]],template:function(t,e){1&t&&(d.Ob(0,"ion-header"),d.Ob(1,"ion-toolbar",0),d.Ob(2,"ion-buttons",1),d.Ob(3,"ion-button",2),d.Wb("click",function(){return e.util.back()}),d.Mb(4,"ion-icon",3),d.Nb(),d.Nb(),d.Ob(5,"ion-title"),d.qc(6),d.Nb(),d.Nb(),d.Nb(),d.Ob(7,"ion-content"),d.Ob(8,"div",4),d.Ob(9,"div",5),d.Mb(10,"div",6,7),d.Nb(),d.Ob(12,"div",8),d.Ob(13,"ion-label",9),d.qc(14),d.Nb(),d.Ob(15,"div",10),d.Mb(16,"div",11),d.Ob(17,"div",12),d.Ob(18,"ion-label",13),d.qc(19),d.Nb(),d.Ob(20,"ion-label",14),d.qc(21),d.Nb(),d.Ob(22,"ion-button",15),d.Wb("click",function(){return e.callDriver()}),d.qc(23),d.Nb(),d.Nb(),d.Nb(),d.Ob(24,"ion-label",16),d.qc(25),d.pc(26,p,2,2,"span",17),d.pc(27,b,2,2,"span",17),d.Nb(),d.Ob(28,"ion-label",16),d.qc(29),d.Ob(30,"span",18),d.qc(31),d.Nb(),d.Nb(),d.Ob(32,"ion-label",16),d.qc(33),d.Ob(34,"span",18),d.qc(35),d.Nb(),d.Nb(),d.Nb(),d.Nb(),d.Nb()),2&t&&(d.Ab(6),d.rc(e.util.translate("Tracking")),d.Ab(8),d.rc(e.util.translate("Order on the Way")),d.Ab(2),d.ec("ngStyle",d.ic(14,_,"url("+e.api.mediaURL+e.cover+"),url(assets/placeholder.jpg)")),d.Ab(3),d.rc(e.username),d.Ab(2),d.rc(e.address),d.Ab(2),d.sc(" ",e.util.translate("CALL")," "),d.Ab(2),d.tc("",e.totalOrders.length," ",e.util.translate("Items to deliver")," "),d.Ab(1),d.ec("ngIf","left"===e.util.cside),d.Ab(1),d.ec("ngIf","right"===e.util.cside),d.Ab(2),d.rc(e.util.translate("Order Status")),d.Ab(2),d.sc(" ",e.status," "),d.Ab(2),d.rc(e.util.translate("Payment")),d.Ab(2),d.sc(" ",e.payMethod," "))},directives:[a.o,a.P,a.i,a.h,a.p,a.N,a.k,a.s,o.k,o.j],styles:[".main_content_div[_ngcontent-%COMP%]{width:100%;height:100vh;display:flex;flex-direction:column;justify-content:space-between}.main_content_div[_ngcontent-%COMP%]   .upper_div[_ngcontent-%COMP%]{height:60vh}.main_content_div[_ngcontent-%COMP%]   .upper_div[_ngcontent-%COMP%]   #map[_ngcontent-%COMP%]{width:100%;height:100%}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]{height:40vh;padding:20px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:block}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .head_lbl[_ngcontent-%COMP%]{font-weight:600;font-size:20px;margin-top:10px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:row;align-items:center;position:relative}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   .back_image[_ngcontent-%COMP%]{height:50px!important;width:50px!important;border-radius:100%;background-position:50%;background-size:cover;background-repeat:no-repeat;min-width:50px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   .boy_name[_ngcontent-%COMP%]{font-weight:600}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{color:gray;width:80%}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{position:absolute;right:-3px;top:-5px;--border-radius:3px;font-weight:600}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .order_detail[_ngcontent-%COMP%]{font-weight:700;margin-top:20px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .order_status[_ngcontent-%COMP%]{background:var(--ion-color-primary);position:absolute;right:20px;color:#fff;padding:3px 8px;border-radius:3px}"]}),t})()}];let m=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({imports:[[r.i.forChild(u)],r.i]}),t})();var h=n("PCNd");let O=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({imports:[[o.b,i.e,a.Q,h.a,m]]}),t})()}}]);